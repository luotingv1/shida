(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-196206ad"],{"06bb":function(e,t,a){"use strict";a("c5ee")},"2e39":function(e,t,a){},"3f58":function(e,t,a){},"464c":function(e,t,a){"use strict";a("3f58")},"4a26":function(e,t,a){},5369:function(e,t,a){"use strict";a("4a26")},"648f":function(e,t,a){e.exports=a.p+"bundle/img/logo.f0dab0b3.jpg"},"685e":function(e,t,a){e.exports=a.p+"bundle/img/headerImage.baefd97f.png"},"6c3f":function(e,t,a){},"6f73":function(e,t,a){"use strict";a.r(t);var s,o,i,n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-layout"},[a("div",{staticClass:"page-header-wrapper"},[a("PageHeader")],1),a("router-view",{staticClass:"sub-page"})],1)},r=[],l=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"components-page-header"},[s("div",{staticClass:"page-header-inner",class:{"layout-container":!e.fullWidth,fullWidth:e.fullWidth}},[s("div",{staticClass:"inline-block logo-wrapper"},[s("img",{staticClass:"cursor-pointer",attrs:{src:a("648f"),alt:""},on:{click:e.goHome}}),e._t("left-slot")],2),s("div",{staticClass:"header-center-wrapper"},[e._t("default")],2),s("div",{staticClass:"user-wrapper"},[e._t("right-slot"),s("userHeadBtn")],2)])])},c=[],u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"user-head-btn-components"},[e.isLogined?a("el-dropdown",[a("div",{staticClass:"inline-block"},[a("div",{staticClass:"user-head-btn-img"},[a("img",{attrs:{src:e.userData.avatar||e.userHeadImage,alt:""}})]),a("span",{staticClass:"user-head-btn-name"},[e._v(e._s(e.userData.name))])]),e.isLogined?a("el-dropdown-menu"):e._e()],1):a("div",{staticClass:"inline-block"},[a("span",{staticClass:"login-btn",on:{click:e.goLogin}},[e._v("登录/注册")])])],1)},d=[],m=a("ade3"),p=(a("7f7f"),a("5c96")),f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"change-password inline-block"},[a("div",{staticClass:"inline-block",on:{click:e.show}},[e._t("default")],2),e.dialogleVisible?a("el-dialog",{staticClass:"page-dialog-wrapper",attrs:{title:"修改密码",width:"480px",visible:e.dialogleVisible,"append-to-body":""},on:{"update:visible":function(t){e.dialogleVisible=t},close:e.closePop}},[a("el-form",{ref:"ruleForm",attrs:{model:e.form,"label-width":"110px",rules:e.rules}},[a("el-form-item",{attrs:{label:"输入旧密码：",prop:"oldPassword"}},[a("el-input",{attrs:{placeholder:"请输入旧密码",type:"password"},model:{value:e.form.oldPassword,callback:function(t){e.$set(e.form,"oldPassword",t)},expression:"form.oldPassword"}})],1),a("el-form-item",{attrs:{label:"输入新密码：",prop:"newPass"}},[a("el-input",{attrs:{placeholder:"最少输入6位数字/字母，不可输入特殊字符",type:"password"},model:{value:e.form.newPass,callback:function(t){e.$set(e.form,"newPass",t)},expression:"form.newPass"}})],1),a("el-form-item",{attrs:{label:"确认新密码：",prop:"newPassword"}},[a("el-input",{attrs:{placeholder:"最少输入6位数字/字母，不可输入特殊字符",type:"password"},model:{value:e.form.newPassword,callback:function(t){e.$set(e.form,"newPassword",t)},expression:"form.newPassword"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closePop}},[e._v("取消")]),a("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.savePassword}},[e._v("提交")])],1)],1):e._e()],1)},g=[],b=a("8dd0"),h={components:(s={},Object(m["a"])(s,p["Form"].name,p["Form"]),Object(m["a"])(s,p["FormItem"].name,p["FormItem"]),Object(m["a"])(s,p["Dialog"].name,p["Dialog"]),Object(m["a"])(s,p["Button"].name,p["Button"]),Object(m["a"])(s,p["Input"].name,p["Input"]),s),data:function(){var e=this,t=function(t,a,s){""===a?s(new Error("请再次输入密码")):a!==e.form.newPass?s(new Error("两次输入密码不一致!")):s()};return{loading:!1,dialogleVisible:!1,form:{newPass:"",oldPassword:"",newPassword:""},rules:{oldPassword:[{required:!0,message:"请输入旧密码",trigger:"blur"},{required:!0,pattern:/^[A-Za-z0-9]\w{5,15}$/,message:"输入6-16位数字或字母，不可输入特殊字符",trigger:"blur"}],newPass:[{required:!0,message:"请输入新密码",trigger:"blur"},{required:!0,pattern:/^[A-Za-z0-9]\w{5,15}$/,message:"输入6-16位数字或字母，不可输入特殊字符",trigger:"blur"}],newPassword:[{required:!0,validator:t,trigger:"blur"}]}}},methods:{show:function(){this.dialogleVisible=!0},savePassword:function(){var e=this;this.$refs["ruleForm"].validate((function(t){if(!t)return!1;e.loading=!0,e.$API.updateUserPass({oldPass:e.form.oldPassword,newPass:e.form.newPass}).then((function(){e.loading=!1,e.$alert("已修改密码，请重新登录","提示",{confirmButtonText:"确定",showClose:!1,closeOnClickModal:!1,closeOnPressEscape:!1,center:!0}).then((function(){b["a"].doLogout()}))})).catch((function(){e.loading=!1}))}))},closePop:function(){this.dialogleVisible=!1,this.$emit("close")}}},w=h,v=(a("464c"),a("0c7c")),P=Object(v["a"])(w,f,g,!1,null,null,null),_=P.exports,k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"user-info-plane-dialog inline-block"},[a("div",{staticClass:"inline-block",on:{click:e.show}},[e._t("default")],2),e.dialogleVisible?a("el-dialog",{staticClass:"page-dialog-wrapper",attrs:{title:"",width:"400px",visible:e.dialogleVisible,"append-to-body":""},on:{"update:visible":function(t){e.dialogleVisible=t},close:e.closePop}},[a("div",{staticClass:"user-info-plane"},[a("div",{staticClass:"user-image-wrapper"},[a("div",{staticClass:"user-image-inner"},[a("img",{attrs:{src:e.userHeadImage}}),e.showEdit?a("div",{staticClass:"user-image-upload"},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"点击头像更换 (只支持jpg、png格式且大小不超过200kb的图片)"}},[a("el-upload",{staticClass:"user-image-upload-input",attrs:{action:"/","before-upload":e.beforeUploadUserHeadImage,accept:"image/gif, image/jpeg, image/png, image/bmp","show-file-list":!1}},[a("i",{staticClass:"el-icon-upload"})])],1)],1):e._e()])]),a("el-form",{attrs:{"label-width":"100px"}},[a("el-form-item",{attrs:{label:"昵称："}},[e.editName?a("div",{staticClass:"edit-name-wrapper"},[a("div",{staticClass:"edit-name-input"},[a("el-input",{model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1),a("el-button",{attrs:{size:"mini",icon:"el-icon-close",circle:""},on:{click:function(t){return e.showEditName(!1)}}}),a("el-button",{attrs:{type:"success",size:"mini",icon:"el-icon-check",circle:""},on:{click:e.saveNickName}})],1):a("div",[a("span",{staticClass:"inline-block marginR20"},[e._v(e._s(e.userData.name))]),e.showEdit?a("el-button",{attrs:{size:"mini",icon:"el-icon-edit",circle:""},on:{click:function(t){return e.showEditName(!0)}}}):e._e()],1)]),a("el-form-item",{attrs:{label:"用户名："}},[a("div",[e._v(e._s(e.userData.username))])]),a("el-form-item",{attrs:{label:"邮箱："}},[a("div",[e._v(e._s(e.userData.email))])]),a("el-form-item",{attrs:{label:"注册时间："}},[a("div",[e._v(e._s(e.userData.created))])])],1)],1)]):e._e()],1)},C=[],I={components:(o={},Object(m["a"])(o,p["Form"].name,p["Form"]),Object(m["a"])(o,p["FormItem"].name,p["FormItem"]),Object(m["a"])(o,p["Dialog"].name,p["Dialog"]),Object(m["a"])(o,p["Button"].name,p["Button"]),Object(m["a"])(o,p["Input"].name,p["Input"]),Object(m["a"])(o,p["Upload"].name,p["Upload"]),Object(m["a"])(o,p["Tooltip"].name,p["Tooltip"]),o),props:{userData:{type:Object,default:function(){return{}}},showEdit:{type:Boolean,default:!1}},data:function(){return{loading:!1,dialogleVisible:!1,editName:!1,name:"",userHeadImage:a("685e")}},created:function(){this.userHeadImage=this.userData.avatar||this.userHeadImage,this.name=this.userData.name},methods:{show:function(){this.dialogleVisible=!0},saveAvatar:function(e){var t=this,a=new FormData;a.append("file",e),this.$API.updateUserAvatar(a).then((function(e){t.$store.commit("UPDATE_USER_INFO",e.body)}))},closePop:function(){this.dialogleVisible=!1,this.$emit("close")},showEditName:function(e){this.name=this.userData.name,this.editName=!!e},saveNickName:function(){var e=this;this.$API.updateNickName({name:this.name}).then((function(t){e.$store.commit("UPDATE_USER_INFO",t.body),e.showEditName(!1)}))},beforeUploadUserHeadImage:function(e){if(!(e.size>204800))return this.saveAvatar(e),!1;this.$message.error("上传图片不能超过200kb！")}},watch:{userData:function(e){this.userHeadImage=e.avatar||this.userHeadImage,this.name=e.name}}},O=I,j=(a("06bb"),Object(v["a"])(O,k,C,!1,null,"1039992e",null)),D=j.exports,$={name:"user-head-btn",components:(i={},Object(m["a"])(i,p["Button"].name,p["Button"]),Object(m["a"])(i,p["Dropdown"].name,p["Dropdown"]),Object(m["a"])(i,p["DropdownMenu"].name,p["DropdownMenu"]),Object(m["a"])(i,p["DropdownItem"].name,p["DropdownItem"]),Object(m["a"])(i,"resetPassword",_),Object(m["a"])(i,"userInfo",D),i),data:function(){return{userHeadImage:a("685e")}},computed:{isLogined:function(){return this.$store.state.user.access_token},userData:function(){return this.$store.state.user.userInfo||{}}},methods:{doLogout:function(){b["a"].doLogout()},goLogin:function(){b["a"].goLogin()}}},E=$,H=(a("a275"),Object(v["a"])(E,u,d,!1,null,"4c220c29",null)),x=H.exports,N={props:{fullWidth:Boolean},components:{userHeadBtn:x},methods:{goHome:function(){this.$store.state.user.access_token,this.$router.push({name:"Home"})}}},y=N,F=(a("5369"),Object(v["a"])(y,l,c,!1,null,"3baac1c6",null)),U=F.exports,V={components:{PageHeader:U}},B=V,A=(a("8f25"),Object(v["a"])(B,n,r,!1,null,"8670a498",null));t["default"]=A.exports},"8f25":function(e,t,a){"use strict";a("6c3f")},a275:function(e,t,a){"use strict";a("2e39")},c5ee:function(e,t,a){}}]);